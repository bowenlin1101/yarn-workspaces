(()=>{"use strict";var n={607:function(n,e,t){var r=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};e.__esModule=!0;var a=r(t(860)),s=r(t(142)),i=t(661),o=r(t(986)),u=(0,a.default)(),c=o.default.json(),d=function(){return Promise.resolve(new i.Database("/tmp/database.db")).then((function(n){return new Promise((function(e,t){n.serialize((function(){e(n)}))}))})).then((function(n){return new Promise((function(e,t){n.run("CREATE TABLE IF NOT EXISTS dishes (id INTEGER PRIMARY KEY, restaurantId INTEGER, name TEXT, description TEXT, imageURL TEXT);",(function(t){e(n)}))}))}))},f=function(){return Promise.resolve(new i.Database("/tmp/database.db")).then((function(n){return new Promise((function(e,t){n.serialize((function(){e(n)}))}))})).then((function(n){return new Promise((function(e,t){n.run("CREATE TABLE IF NOT EXISTS restaurants (id INTEGER PRIMARY KEY, name TEXT, description TEXT, cuisine TEXT, website TEXT;",(function(t){e(n)}))}))}))};u.get("/restaurants",(function(n,e){f().then((function(n){new Promise((function(e,t){n.all("SELECT * FROM restaurants;",(function(n,r){n?t(n):e(r)}))})).then((function(n){e.send(n)}))}))})),u.get("/dishes",(function(n,e){d().then((function(n){new Promise((function(e,t){n.all("SELECT * from dishes;",(function(n,t){e(t)}))}))})).then((function(n){e.send(n)}))})),u.get("/restaurants/:restaurantId",(function(n,e){f().then((function(t){return new Promise((function(r,a){t.all("SELECT * FROM restaurants where id = ".concat(n.params.restaurantId,";"),(function(n,t){e.send(t)}))}))}))})),u.get("/restaurants/:restaurantId/dishes",(function(n,e){d().then((function(t){return new Promise((function(r,a){t.all("SELECT * FROM dishes WHERE restaurantId = ".concat(n.params.restaurantId,";"),(function(n,t){e.send(t)}))}))}))})),u.get("/restaurants/:restaurantId/dishes/:dishId",(function(n,e){d().then((function(t){return new Promise((function(r,a){t.all("SELECT * FROM dishes WHERE restaurantId = ".concat(n.params.restaurantId," AND dishId = ").concat(n.params.dishId,";"),(function(n,t){e.send(t)}))}))}))})),u.delete("/restaurants/:restaurantId",(function(n,e){f().then((function(t){new Promise((function(r,a){t.run("DELETE FROM restaurants WHERE id = ".concat(n.params.restaurantId,";"),(function(n){n?e.send("error"):e.send("restaurant and containing dishes deleted"),r(null)}))}))})),d().then((function(t){new Promise((function(r,a){t.run("DELETE FROM dishes WHERE restaurantId = ".concat(n.params.restaurantId,";"),(function(n){n?e.send("error"):e.send("dish deleted")}))})).then((function(){t.close()}))}))})),u.delete("/restaurants/:restaurantId/dishes/:dishId",(function(n,e){d().then((function(t){new Promise((function(r,a){t.run("DELETE FROM dishes WHERE restaurantId = ".concat(n.params.restaurantId," AND id = ").concat(n.params.dishId,";"),(function(n){n?e.send("error"):e.send("dish deleted"),r(null)}))}))}))})),u.post("/restaurants",c,(function(n,e){f().then((function(t){new Promise((function(){t.run(function(n,e,t,r){var a="INSERT INTO restaurants (name",s="VALUES (";if(n)return s+="'".concat(n,"'"),e&&(a+=", description",s+=", '".concat(e,"'")),t&&(a+=", cuisine",s+=", '".concat(t,"'")),r&&(a+=", website",s+=", '".concat(r,"'")),(a+=") ")+s+");"}(n.body.name,n.body.description,n.body.cuisine,n.body.website),(function(n){n?e.send("error"):e.send("Restaurant created")}))}))}))})),u.post("/restaurants/:restaurantId/dishes",c,(function(n,e){d().then((function(t){new Promise((function(){t.run(function(n,e,t,r){var a="INSERT INTO dishes (name",s="VALUES (";if(e)return s+="'".concat(e,"'"),t&&(a+=", description",s+=", '".concat(t,"'")),n&&(a+=", restaurantId",s+=", ".concat(n)),r&&(a+=", imageURL",s+=", '".concat(r,"'")),(a+=") ")+s+");"}(n.body.restaurantId?parseInt(n.body.restaurantId):parseInt(n.params.restaurantId),n.body.name,n.body.description,n.body.imageURL),(function(n){n?e.send("error"):e.send("dish created")}))}))}))})),u.put("/restaurants/:restaurantId",c,(function(n,e){f().then((function(t){new Promise((function(){var r,a,s,i,o,u;t.run((r=parseInt(n.params.restaurantId),a=n.body.name,s=n.body.description,i=n.body.cuisine,o=n.body.website,u="UPDATE restaurants SET",a&&(u+=", name = '".concat(a.replace("'","''"),"'")),s&&(u+=", description = '".concat(s.replace("'","''"),"'")),i&&(u+=", cuisine = '".concat(i.replace("'","''"),"'")),o&&(u+=", website = '".concat(o.replace("'","''"),"'")),(u+=" WHERE id = ".concat(r,";")).replace(",","")),(function(n){n?e.send("error"):e.send("updated")}))}))}))})),u.put("/restaurants/:restaurantId/dishes/:dishId",c,(function(n,e){d().then((function(t){new Promise((function(){var r,a,s,i,o,u;t.run((r=parseInt(n.params.dishId),a=n.body.restaurantId?parseInt(n.body.restaurantId):parseInt(n.params.restaurantId),s=n.body.name,i=n.body.description,o=n.body.imageURL,u="UPDATE dishes SET",s&&(u+=", name = '".concat(s.replace("'","''"),"'")),i&&(u+=", description = '".concat(i.replace("'","''"),"'")),a&&(u+=", restaurantId = ".concat(a)),o&&(u+=", imageURL = '".concat(o.replace("'","''"),"'")),(u+=" WHERE id = ".concat(r,";")).replace(",","")),(function(n){n?e.send("error"):e.send("updated")}))}))}))})),s.default.config(),u.listen(8e3,(function(){console.log("⚡️[server]: Server is running at https://localhost:".concat(8e3))}))},986:n=>{n.exports=require("body-parser")},142:n=>{n.exports=require("dotenv")},860:n=>{n.exports=require("express")},661:n=>{n.exports=require("sqlite3")}},e={};!function t(r){var a=e[r];if(void 0!==a)return a.exports;var s=e[r]={exports:{}};return n[r].call(s.exports,s,s.exports,t),s.exports}(607)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Qm5CLE9BQU9FLElBRXJDWSxJQUNBSyxHQUFVLGlCQUFpQm5CLE9BQU9jLEVBQVNNLFFBQVEsSUFBSyxNQUFPLE9BRW5FRCxHQUFVLGVBQWVuQixPQUFPa0IsRUFBSSxNQUN0QkUsUUFBUSxJQUFLLE1BM0ZtTixTQUFVN0IsR0FDeE9BLEVBQ0FJLEVBQVNJLEtBQUssU0FFZEosRUFBU0ksS0FBSyx1QkF5RmxDdkIsRUFBa0IsUUFBRTZDLFNBRXBCMUMsRUFBSTJDLE9BRE8sS0FDTSxXQUNiQyxRQUFRQyxJQUFJLHNEQUFnRXhCLE9BRnJFLFUsUUM1U1h5QixFQUFPbkQsUUFBVW9ELFFBQVEsZ0IsUUNBekJELEVBQU9uRCxRQUFVb0QsUUFBUSxXLFFDQXpCRCxFQUFPbkQsUUFBVW9ELFFBQVEsWSxRQ0F6QkQsRUFBT25ELFFBQVVvRCxRQUFRLGFDQ3JCQyxFQUEyQixJQUcvQixTQUFTQyxFQUFvQkMsR0FFNUIsSUFBSUMsRUFBZUgsRUFBeUJFLEdBQzVDLFFBQXFCRSxJQUFqQkQsRUFDSCxPQUFPQSxFQUFheEQsUUFHckIsSUFBSW1ELEVBQVNFLEVBQXlCRSxHQUFZLENBR2pEdkQsUUFBUyxJQU9WLE9BSEEwRCxFQUFvQkgsR0FBVUksS0FBS1IsRUFBT25ELFFBQVNtRCxFQUFRQSxFQUFPbkQsUUFBU3NELEdBR3BFSCxFQUFPbkQsUUNsQldzRCxDQUFvQixNIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVzdGF1cmFudC1hcGkvLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vcmVzdGF1cmFudC1hcGkvZXh0ZXJuYWwgY29tbW9uanMgXCJib2R5LXBhcnNlclwiIiwid2VicGFjazovL3Jlc3RhdXJhbnQtYXBpL2V4dGVybmFsIGNvbW1vbmpzIFwiZG90ZW52XCIiLCJ3ZWJwYWNrOi8vcmVzdGF1cmFudC1hcGkvZXh0ZXJuYWwgY29tbW9uanMgXCJleHByZXNzXCIiLCJ3ZWJwYWNrOi8vcmVzdGF1cmFudC1hcGkvZXh0ZXJuYWwgY29tbW9uanMgXCJzcWxpdGUzXCIiLCJ3ZWJwYWNrOi8vcmVzdGF1cmFudC1hcGkvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vcmVzdGF1cmFudC1hcGkvd2VicGFjay9zdGFydHVwIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xudmFyIF9faW1wb3J0RGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnREZWZhdWx0KSB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XG59O1xuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbnZhciBleHByZXNzXzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcImV4cHJlc3NcIikpO1xudmFyIGRvdGVudl8xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCJkb3RlbnZcIikpO1xudmFyIHNxbGl0ZTNfMSA9IHJlcXVpcmUoXCJzcWxpdGUzXCIpO1xudmFyIGJvZHlfcGFyc2VyXzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcImJvZHktcGFyc2VyXCIpKTtcbnZhciBhcHAgPSAoMCwgZXhwcmVzc18xW1wiZGVmYXVsdFwiXSkoKTtcbnZhciBqc29uUGFyc2VyID0gYm9keV9wYXJzZXJfMVtcImRlZmF1bHRcIl0uanNvbigpO1xuLy9Jbml0aWFsaXplIGRpc2hlc1xudmFyIGluaXREaXNoRGIgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShuZXcgc3FsaXRlM18xLkRhdGFiYXNlKCcvdG1wL2RhdGFiYXNlLmRiJykpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYikge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgZGIuc2VyaWFsaXplKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGRiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbiAoZGIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIGRiLnJ1bignQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgZGlzaGVzIChpZCBJTlRFR0VSIFBSSU1BUlkgS0VZLCByZXN0YXVyYW50SWQgSU5URUdFUiwgbmFtZSBURVhULCBkZXNjcmlwdGlvbiBURVhULCBpbWFnZVVSTCBURVhUKTsnLCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGRiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn07XG4vL0luaXRpYWxpemUgcmVzdGF1cmFudHNcbnZhciBpbml0UmVzdGF1cmFudERiID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IHNxbGl0ZTNfMS5EYXRhYmFzZSgnL3RtcC9kYXRhYmFzZS5kYicpKVxuICAgICAgICAudGhlbihmdW5jdGlvbiAoZGIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIGRiLnNlcmlhbGl6ZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShkYik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRiKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICBkYi5ydW4oJ0NSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIHJlc3RhdXJhbnRzIChpZCBJTlRFR0VSIFBSSU1BUlkgS0VZLCBuYW1lIFRFWFQsIGRlc2NyaXB0aW9uIFRFWFQsIGN1aXNpbmUgVEVYVCwgd2Vic2l0ZSBURVhUOycsIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoZGIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufTtcbi8vR0VUIFJlc3RhdXJhbnRzXG5hcHAuZ2V0KCcvcmVzdGF1cmFudHMnLCBmdW5jdGlvbiAocmVxdWVzdCwgcmVzcG9uc2UpIHtcbiAgICBpbml0UmVzdGF1cmFudERiKClcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRiKSB7XG4gICAgICAgIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIGRiLmFsbCgnU0VMRUNUICogRlJPTSByZXN0YXVyYW50czsnLCBmdW5jdGlvbiAoZXJyb3IsIHJvd3MpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IpXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJvd3MpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzdWx0cykge1xuICAgICAgICAgICAgcmVzcG9uc2Uuc2VuZChyZXN1bHRzKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59KTtcbi8vR0VUIGRpc2hlc1xuYXBwLmdldCgnL2Rpc2hlcycsIGZ1bmN0aW9uIChyZXF1ZXN0LCByZXNwb25zZSkge1xuICAgIGluaXREaXNoRGIoKVxuICAgICAgICAudGhlbihmdW5jdGlvbiAoZGIpIHtcbiAgICAgICAgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgZGIuYWxsKCdTRUxFQ1QgKiBmcm9tIGRpc2hlczsnLCBmdW5jdGlvbiAoZXJyb3IsIHJvd3MpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHJvd3MpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0pXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uIChyb3dzKSB7XG4gICAgICAgIHJlc3BvbnNlLnNlbmQocm93cyk7XG4gICAgfSk7XG59KTtcbi8vR0VUIHNwZWNpZmljIHJlc3RhdXJhbnRcbmFwcC5nZXQoJy9yZXN0YXVyYW50cy86cmVzdGF1cmFudElkJywgZnVuY3Rpb24gKHJlcXVlc3QsIHJlc3BvbnNlKSB7XG4gICAgaW5pdFJlc3RhdXJhbnREYigpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYikge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgZGIuYWxsKFwiU0VMRUNUICogRlJPTSByZXN0YXVyYW50cyB3aGVyZSBpZCA9IFwiLmNvbmNhdChyZXF1ZXN0LnBhcmFtcy5yZXN0YXVyYW50SWQsIFwiO1wiKSwgZnVuY3Rpb24gKGVycm9yLCByb3dzKSB7XG4gICAgICAgICAgICAgICAgcmVzcG9uc2Uuc2VuZChyb3dzKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn0pO1xuLy9HRVQgYWxsIGRpc2hlcyBmcm9tIGEgcmVzdGF1cmFudFxuYXBwLmdldCgnL3Jlc3RhdXJhbnRzLzpyZXN0YXVyYW50SWQvZGlzaGVzJywgZnVuY3Rpb24gKHJlcXVlc3QsIHJlc3BvbnNlKSB7XG4gICAgaW5pdERpc2hEYigpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYikge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgZGIuYWxsKFwiU0VMRUNUICogRlJPTSBkaXNoZXMgV0hFUkUgcmVzdGF1cmFudElkID0gXCIuY29uY2F0KHJlcXVlc3QucGFyYW1zLnJlc3RhdXJhbnRJZCwgXCI7XCIpLCBmdW5jdGlvbiAoZXJyb3IsIHJvd3MpIHtcbiAgICAgICAgICAgICAgICByZXNwb25zZS5zZW5kKHJvd3MpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufSk7XG4vL0dFVCBzcGVjaWZpYyBkaXNoIGZyb20gYSByZXN0YXVyYW50XG5hcHAuZ2V0KCcvcmVzdGF1cmFudHMvOnJlc3RhdXJhbnRJZC9kaXNoZXMvOmRpc2hJZCcsIGZ1bmN0aW9uIChyZXF1ZXN0LCByZXNwb25zZSkge1xuICAgIGluaXREaXNoRGIoKVxuICAgICAgICAudGhlbihmdW5jdGlvbiAoZGIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIGRiLmFsbChcIlNFTEVDVCAqIEZST00gZGlzaGVzIFdIRVJFIHJlc3RhdXJhbnRJZCA9IFwiLmNvbmNhdChyZXF1ZXN0LnBhcmFtcy5yZXN0YXVyYW50SWQsIFwiIEFORCBkaXNoSWQgPSBcIikuY29uY2F0KHJlcXVlc3QucGFyYW1zLmRpc2hJZCwgXCI7XCIpLCBmdW5jdGlvbiAoZXJyb3IsIHJvd3MpIHtcbiAgICAgICAgICAgICAgICByZXNwb25zZS5zZW5kKHJvd3MpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufSk7XG4vL0RFTEVURSByZXN0YXVyYW50XG5hcHBbXCJkZWxldGVcIl0oJy9yZXN0YXVyYW50cy86cmVzdGF1cmFudElkJywgZnVuY3Rpb24gKHJlcXVlc3QsIHJlc3BvbnNlKSB7XG4gICAgaW5pdFJlc3RhdXJhbnREYigpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYikge1xuICAgICAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhgREVMRVRFIEZST00gcmVzdGF1cmFudHMgV0hFUkUgaWQgPSAke3JlcXVlc3QucGFyYW1zLnJlc3RhdXJhbnRJZH07YClcbiAgICAgICAgICAgIGRiLnJ1bihcIkRFTEVURSBGUk9NIHJlc3RhdXJhbnRzIFdIRVJFIGlkID0gXCIuY29uY2F0KHJlcXVlc3QucGFyYW1zLnJlc3RhdXJhbnRJZCwgXCI7XCIpLCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IpXG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLnNlbmQoXCJlcnJvclwiKTtcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLnNlbmQoXCJyZXN0YXVyYW50IGFuZCBjb250YWluaW5nIGRpc2hlcyBkZWxldGVkXCIpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUobnVsbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgaW5pdERpc2hEYigpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYikge1xuICAgICAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICBkYi5ydW4oXCJERUxFVEUgRlJPTSBkaXNoZXMgV0hFUkUgcmVzdGF1cmFudElkID0gXCIuY29uY2F0KHJlcXVlc3QucGFyYW1zLnJlc3RhdXJhbnRJZCwgXCI7XCIpLCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IpXG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLnNlbmQoXCJlcnJvclwiKTtcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLnNlbmQoXCJkaXNoIGRlbGV0ZWRcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGRiLmNsb3NlKCk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufSk7XG4vL0RFTEVURSBkaXNoXG5hcHBbXCJkZWxldGVcIl0oXCIvcmVzdGF1cmFudHMvOnJlc3RhdXJhbnRJZC9kaXNoZXMvOmRpc2hJZFwiLCBmdW5jdGlvbiAocmVxdWVzdCwgcmVzcG9uc2UpIHtcbiAgICBpbml0RGlzaERiKClcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRiKSB7XG4gICAgICAgIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIGRiLnJ1bihcIkRFTEVURSBGUk9NIGRpc2hlcyBXSEVSRSByZXN0YXVyYW50SWQgPSBcIi5jb25jYXQocmVxdWVzdC5wYXJhbXMucmVzdGF1cmFudElkLCBcIiBBTkQgaWQgPSBcIikuY29uY2F0KHJlcXVlc3QucGFyYW1zLmRpc2hJZCwgXCI7XCIpLCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IpXG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLnNlbmQoXCJlcnJvclwiKTtcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLnNlbmQoXCJkaXNoIGRlbGV0ZWRcIik7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShudWxsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn0pO1xuLy8gQUREIHJlc3RhdXJhbnRcbmFwcC5wb3N0KFwiL3Jlc3RhdXJhbnRzXCIsIGpzb25QYXJzZXIsIGZ1bmN0aW9uIChyZXF1ZXN0LCByZXNwb25zZSkge1xuICAgIGluaXRSZXN0YXVyYW50RGIoKVxuICAgICAgICAudGhlbihmdW5jdGlvbiAoZGIpIHtcbiAgICAgICAgbmV3IFByb21pc2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZGIucnVuKGNyZWF0ZVJlc3RhdXJhbnRJbnB1dChyZXF1ZXN0LmJvZHkubmFtZSwgcmVxdWVzdC5ib2R5LmRlc2NyaXB0aW9uLCByZXF1ZXN0LmJvZHkuY3Vpc2luZSwgcmVxdWVzdC5ib2R5LndlYnNpdGUpLCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IpXG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLnNlbmQoXCJlcnJvclwiKTtcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLnNlbmQoXCJSZXN0YXVyYW50IGNyZWF0ZWRcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59KTtcbi8vQUREIGRpc2hcbmFwcC5wb3N0KCcvcmVzdGF1cmFudHMvOnJlc3RhdXJhbnRJZC9kaXNoZXMnLCBqc29uUGFyc2VyLCBmdW5jdGlvbiAocmVxdWVzdCwgcmVzcG9uc2UpIHtcbiAgICBpbml0RGlzaERiKClcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRiKSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGNyZWF0ZURpc2hJbnB1dChyZXF1ZXN0LmJvZHkucmVzdGF1cmFudElkID8gcGFyc2VJbnQocmVxdWVzdC5ib2R5LnJlc3RhdXJhbnRJZCkgOiBwYXJzZUludChyZXF1ZXN0LnBhcmFtcy5yZXN0YXVyYW50SWQpLCByZXF1ZXN0LmJvZHkubmFtZSwgcmVxdWVzdC5ib2R5LmRlc2NyaXB0aW9uLCByZXF1ZXN0LmJvZHkuaW1hZ2VVUkwpKVxuICAgICAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBkYi5ydW4oY3JlYXRlRGlzaElucHV0KHJlcXVlc3QuYm9keS5yZXN0YXVyYW50SWQgPyBwYXJzZUludChyZXF1ZXN0LmJvZHkucmVzdGF1cmFudElkKSA6IHBhcnNlSW50KHJlcXVlc3QucGFyYW1zLnJlc3RhdXJhbnRJZCksIHJlcXVlc3QuYm9keS5uYW1lLCByZXF1ZXN0LmJvZHkuZGVzY3JpcHRpb24sIHJlcXVlc3QuYm9keS5pbWFnZVVSTCksIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGlmIChlcnJvcilcbiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2Uuc2VuZCgnZXJyb3InKTtcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLnNlbmQoJ2Rpc2ggY3JlYXRlZCcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufSk7XG4vL1VQREFURSByZXN0YXVyYW50XG5hcHAucHV0KCcvcmVzdGF1cmFudHMvOnJlc3RhdXJhbnRJZCcsIGpzb25QYXJzZXIsIGZ1bmN0aW9uIChyZXF1ZXN0LCByZXNwb25zZSkge1xuICAgIGluaXRSZXN0YXVyYW50RGIoKVxuICAgICAgICAudGhlbihmdW5jdGlvbiAoZGIpIHtcbiAgICAgICAgbmV3IFByb21pc2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2codXBkYXRlUmVzdGF1cmFudElucHV0KHBhcnNlSW50KHJlcXVlc3QucGFyYW1zLnJlc3RhdXJhbnRJZCksIHJlcXVlc3QuYm9keS5uYW1lLCByZXF1ZXN0LmJvZHkuZGVzY3JpcHRpb24sIHJlcXVlc3QuYm9keS5jdWlzaW5lLCByZXF1ZXN0LmJvZHkud2Vic2l0ZSkpXG4gICAgICAgICAgICBkYi5ydW4odXBkYXRlUmVzdGF1cmFudElucHV0KHBhcnNlSW50KHJlcXVlc3QucGFyYW1zLnJlc3RhdXJhbnRJZCksIHJlcXVlc3QuYm9keS5uYW1lLCByZXF1ZXN0LmJvZHkuZGVzY3JpcHRpb24sIHJlcXVlc3QuYm9keS5jdWlzaW5lLCByZXF1ZXN0LmJvZHkud2Vic2l0ZSksIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGlmIChlcnJvcilcbiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2Uuc2VuZChcImVycm9yXCIpO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2Uuc2VuZChcInVwZGF0ZWRcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59KTtcbi8vVVBEQVRFIGRpc2hcbmFwcC5wdXQoJy9yZXN0YXVyYW50cy86cmVzdGF1cmFudElkL2Rpc2hlcy86ZGlzaElkJywganNvblBhcnNlciwgZnVuY3Rpb24gKHJlcXVlc3QsIHJlc3BvbnNlKSB7XG4gICAgaW5pdERpc2hEYigpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYikge1xuICAgICAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh1cGRhdGVEaXNoSW5wdXQocGFyc2VJbnQocmVxdWVzdC5wYXJhbXMuZGlzaElkKSwgcGFyc2VJbnQocmVxdWVzdC5ib2R5LnJlc3RhdXJhbnRJZCksIHJlcXVlc3QuYm9keS5uYW1lLCByZXF1ZXN0LmJvZHkuZGVzY3JpcHRpb24sIHJlcXVlc3QuYm9keS5pbWFnZVVSTCkpXG4gICAgICAgICAgICBkYi5ydW4odXBkYXRlRGlzaElucHV0KHBhcnNlSW50KHJlcXVlc3QucGFyYW1zLmRpc2hJZCksIHJlcXVlc3QuYm9keS5yZXN0YXVyYW50SWQgPyBwYXJzZUludChyZXF1ZXN0LmJvZHkucmVzdGF1cmFudElkKSA6IHBhcnNlSW50KHJlcXVlc3QucGFyYW1zLnJlc3RhdXJhbnRJZCksIHJlcXVlc3QuYm9keS5uYW1lLCByZXF1ZXN0LmJvZHkuZGVzY3JpcHRpb24sIHJlcXVlc3QuYm9keS5pbWFnZVVSTCksIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGlmIChlcnJvcilcbiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2Uuc2VuZChcImVycm9yXCIpO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2Uuc2VuZCgndXBkYXRlZCcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufSk7XG5mdW5jdGlvbiBjcmVhdGVSZXN0YXVyYW50SW5wdXQobmFtZSwgZGVzY3JpcHRpb24sIGN1aXNpbmUsIHdlYnNpdGUpIHtcbiAgICB2YXIgaW5zZXJ0ID0gXCJJTlNFUlQgSU5UTyByZXN0YXVyYW50cyAobmFtZVwiO1xuICAgIHZhciB2YWx1ZXMgPSBcIlZBTFVFUyAoXCI7XG4gICAgaWYgKG5hbWUpIHtcbiAgICAgICAgdmFsdWVzICs9IFwiJ1wiLmNvbmNhdChuYW1lLCBcIidcIik7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBpZiAoZGVzY3JpcHRpb24pIHtcbiAgICAgICAgaW5zZXJ0ICs9IFwiLCBkZXNjcmlwdGlvblwiO1xuICAgICAgICB2YWx1ZXMgKz0gXCIsICdcIi5jb25jYXQoZGVzY3JpcHRpb24sIFwiJ1wiKTtcbiAgICB9XG4gICAgaWYgKGN1aXNpbmUpIHtcbiAgICAgICAgaW5zZXJ0ICs9IFwiLCBjdWlzaW5lXCI7XG4gICAgICAgIHZhbHVlcyArPSBcIiwgJ1wiLmNvbmNhdChjdWlzaW5lLCBcIidcIik7XG4gICAgfVxuICAgIGlmICh3ZWJzaXRlKSB7XG4gICAgICAgIGluc2VydCArPSAnLCB3ZWJzaXRlJztcbiAgICAgICAgdmFsdWVzICs9IFwiLCAnXCIuY29uY2F0KHdlYnNpdGUsIFwiJ1wiKTtcbiAgICB9XG4gICAgaW5zZXJ0ICs9ICcpICc7XG4gICAgdmFsdWVzICs9ICcpOyc7XG4gICAgcmV0dXJuIGluc2VydCArIHZhbHVlcztcbn1cbmZ1bmN0aW9uIGNyZWF0ZURpc2hJbnB1dChyZXN0YXVyYW50SWQsIG5hbWUsIGRlc2NyaXB0aW9uLCBpbWFnZVVSTCkge1xuICAgIHZhciBpbnNlcnQgPSBcIklOU0VSVCBJTlRPIGRpc2hlcyAobmFtZVwiO1xuICAgIHZhciB2YWx1ZXMgPSBcIlZBTFVFUyAoXCI7XG4gICAgaWYgKG5hbWUpIHtcbiAgICAgICAgdmFsdWVzICs9IFwiJ1wiLmNvbmNhdChuYW1lLCBcIidcIik7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBpZiAoZGVzY3JpcHRpb24pIHtcbiAgICAgICAgaW5zZXJ0ICs9IFwiLCBkZXNjcmlwdGlvblwiO1xuICAgICAgICB2YWx1ZXMgKz0gXCIsICdcIi5jb25jYXQoZGVzY3JpcHRpb24sIFwiJ1wiKTtcbiAgICB9XG4gICAgaWYgKHJlc3RhdXJhbnRJZCkge1xuICAgICAgICBpbnNlcnQgKz0gXCIsIHJlc3RhdXJhbnRJZFwiO1xuICAgICAgICB2YWx1ZXMgKz0gXCIsIFwiLmNvbmNhdChyZXN0YXVyYW50SWQpO1xuICAgIH1cbiAgICBpZiAoaW1hZ2VVUkwpIHtcbiAgICAgICAgaW5zZXJ0ICs9ICcsIGltYWdlVVJMJztcbiAgICAgICAgdmFsdWVzICs9IFwiLCAnXCIuY29uY2F0KGltYWdlVVJMLCBcIidcIik7XG4gICAgfVxuICAgIGluc2VydCArPSAnKSAnO1xuICAgIHZhbHVlcyArPSAnKTsnO1xuICAgIHJldHVybiBpbnNlcnQgKyB2YWx1ZXM7XG59XG5mdW5jdGlvbiB1cGRhdGVSZXN0YXVyYW50SW5wdXQoaWQsIG5hbWUsIGRlc2NyaXB0aW9uLCBjdWlzaW5lLCB3ZWJzaXRlKSB7XG4gICAgdmFyIHVwZGF0ZSA9IFwiVVBEQVRFIHJlc3RhdXJhbnRzIFNFVFwiO1xuICAgIGlmIChuYW1lKSB7XG4gICAgICAgIHVwZGF0ZSArPSBcIiwgbmFtZSA9ICdcIi5jb25jYXQobmFtZS5yZXBsYWNlKFwiJ1wiLCBcIicnXCIpLCBcIidcIik7XG4gICAgfVxuICAgIGlmIChkZXNjcmlwdGlvbikge1xuICAgICAgICB1cGRhdGUgKz0gXCIsIGRlc2NyaXB0aW9uID0gJ1wiLmNvbmNhdChkZXNjcmlwdGlvbi5yZXBsYWNlKFwiJ1wiLCBcIicnXCIpLCBcIidcIik7XG4gICAgfVxuICAgIGlmIChjdWlzaW5lKSB7XG4gICAgICAgIHVwZGF0ZSArPSBcIiwgY3Vpc2luZSA9ICdcIi5jb25jYXQoY3Vpc2luZS5yZXBsYWNlKFwiJ1wiLCBcIicnXCIpLCBcIidcIik7XG4gICAgfVxuICAgIGlmICh3ZWJzaXRlKSB7XG4gICAgICAgIHVwZGF0ZSArPSBcIiwgd2Vic2l0ZSA9ICdcIi5jb25jYXQod2Vic2l0ZS5yZXBsYWNlKFwiJ1wiLCBcIicnXCIpLCBcIidcIik7XG4gICAgfVxuICAgIHVwZGF0ZSArPSBcIiBXSEVSRSBpZCA9IFwiLmNvbmNhdChpZCwgXCI7XCIpO1xuICAgIHJldHVybiB1cGRhdGUucmVwbGFjZShcIixcIiwgXCJcIik7XG59XG5mdW5jdGlvbiB1cGRhdGVEaXNoSW5wdXQoaWQsIHJlc3RhdXJhbnRJZCwgbmFtZSwgZGVzY3JpcHRpb24sIGltYWdlVVJMKSB7XG4gICAgdmFyIHVwZGF0ZSA9IFwiVVBEQVRFIGRpc2hlcyBTRVRcIjtcbiAgICBpZiAobmFtZSkge1xuICAgICAgICB1cGRhdGUgKz0gXCIsIG5hbWUgPSAnXCIuY29uY2F0KG5hbWUucmVwbGFjZShcIidcIiwgXCInJ1wiKSwgXCInXCIpO1xuICAgIH1cbiAgICBpZiAoZGVzY3JpcHRpb24pIHtcbiAgICAgICAgdXBkYXRlICs9IFwiLCBkZXNjcmlwdGlvbiA9ICdcIi5jb25jYXQoZGVzY3JpcHRpb24ucmVwbGFjZShcIidcIiwgXCInJ1wiKSwgXCInXCIpO1xuICAgIH1cbiAgICBpZiAocmVzdGF1cmFudElkKSB7XG4gICAgICAgIHVwZGF0ZSArPSBcIiwgcmVzdGF1cmFudElkID0gXCIuY29uY2F0KHJlc3RhdXJhbnRJZCk7XG4gICAgfVxuICAgIGlmIChpbWFnZVVSTCkge1xuICAgICAgICB1cGRhdGUgKz0gXCIsIGltYWdlVVJMID0gJ1wiLmNvbmNhdChpbWFnZVVSTC5yZXBsYWNlKFwiJ1wiLCBcIicnXCIpLCBcIidcIik7XG4gICAgfVxuICAgIHVwZGF0ZSArPSBcIiBXSEVSRSBpZCA9IFwiLmNvbmNhdChpZCwgXCI7XCIpO1xuICAgIHJldHVybiB1cGRhdGUucmVwbGFjZShcIixcIiwgXCJcIik7XG59XG5kb3RlbnZfMVtcImRlZmF1bHRcIl0uY29uZmlnKCk7XG52YXIgcG9ydCA9IDgwMDA7XG5hcHAubGlzdGVuKHBvcnQsIGZ1bmN0aW9uICgpIHtcbiAgICBjb25zb2xlLmxvZyhcIlxcdTI2QTFcXHVGRTBGW3NlcnZlcl06IFNlcnZlciBpcyBydW5uaW5nIGF0IGh0dHBzOi8vbG9jYWxob3N0OlwiLmNvbmNhdChwb3J0KSk7XG59KTtcbiIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImJvZHktcGFyc2VyXCIpOyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImRvdGVudlwiKTsiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJleHByZXNzXCIpOyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInNxbGl0ZTNcIik7IiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLy8gVGhpcyBlbnRyeSBtb2R1bGUgaXMgcmVmZXJlbmNlZCBieSBvdGhlciBtb2R1bGVzIHNvIGl0IGNhbid0IGJlIGlubGluZWRcbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MDcpO1xuIl0sIm5hbWVzIjpbIl9faW1wb3J0RGVmYXVsdCIsInRoaXMiLCJtb2QiLCJfX2VzTW9kdWxlIiwiZXhwb3J0cyIsImV4cHJlc3NfMSIsImRvdGVudl8xIiwic3FsaXRlM18xIiwiYm9keV9wYXJzZXJfMSIsImFwcCIsImpzb25QYXJzZXIiLCJqc29uIiwiaW5pdERpc2hEYiIsIlByb21pc2UiLCJyZXNvbHZlIiwiRGF0YWJhc2UiLCJ0aGVuIiwiZGIiLCJyZWplY3QiLCJzZXJpYWxpemUiLCJydW4iLCJlcnJvciIsImluaXRSZXN0YXVyYW50RGIiLCJnZXQiLCJyZXF1ZXN0IiwicmVzcG9uc2UiLCJhbGwiLCJyb3dzIiwicmVzdWx0cyIsInNlbmQiLCJjb25jYXQiLCJwYXJhbXMiLCJyZXN0YXVyYW50SWQiLCJkaXNoSWQiLCJjbG9zZSIsInBvc3QiLCJuYW1lIiwiZGVzY3JpcHRpb24iLCJjdWlzaW5lIiwid2Vic2l0ZSIsImluc2VydCIsInZhbHVlcyIsImNyZWF0ZVJlc3RhdXJhbnRJbnB1dCIsImJvZHkiLCJpbWFnZVVSTCIsImNyZWF0ZURpc2hJbnB1dCIsInBhcnNlSW50IiwicHV0IiwiaWQiLCJ1cGRhdGUiLCJyZXBsYWNlIiwiY29uZmlnIiwibGlzdGVuIiwiY29uc29sZSIsImxvZyIsIm1vZHVsZSIsInJlcXVpcmUiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiY2FsbCJdLCJzb3VyY2VSb290IjoiIn0=